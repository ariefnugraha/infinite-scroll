$(document).ready(function () {
  const listNews = [
    {
      url: "index.html",
      breadcrumb: ["Home", "Teknologi", "Game"],
      category: "Teknologi",
      topics: [
        "game",
        "xbox",
        "nintendo switch",
        "ps 5",
        "gta",
        "gta Definitive Edition",
      ],
      title:
        "GTA Trilogy: Definitive Edition Bikin Kecewa, Rockstar Minta Maaf dan Janjikan Ini",
      subtitle: "",
      author: "Muhammad Syahrul Ramadhan",
      date: "28 November 2021 21:37",
      imageAlt:
        "GTA Trilogy bikin kecewa, Rockstar minta maaf(Foto: Gamesprout)",
      imageSrc:
        "https://cdn.medcom.id/dynamic/content/2021/11/21/1355398/KanAcN6iIO.jpg?w=1024",
      listText: [
        "Brenda never wanted to be famous. While most of her friends dreamed about being famous, she could see the negative aspects that those who wanted to be famous seemed to ignore. The fact that you could never do anything in public without being mobbed and the complete lack of privacy was something that she never wanted to experience. She also had no desire to have strangers speculating about every aspect of her life and what each thing she did was supposed to mean. Brenda was perfectly happy with her anonymous life where she could do exactly as she wanted without anyone else giving a damn. Thus, her overnight Internet celebrity was not something she was thrilled about as her friends told her how lucky she was. He scolded himself for being so tentative. He knew he shouldn't be so cautious, but there was a sixth sense telling him that things weren't exactly as they appeared. It was that weird chill that rolls up your neck and makes the hair stand on end. He knew that being so tentative could end up costing him the job, but he learned that listening to his sixth sense usually kept him from getting into a lot of trouble. They had no proof. He knew that they knew he had done it but they didn't have any proof. It was a huge distinction and it was the difference between him keeping his freedom or being locked away for decades. They continued to question him, probing him for information that they could use against him or find the proof they needed to put him away. He smiled and continued to block their every inquiry by feigning his innocence for a crime they all knew he committed.",
        "It wasn't supposed to end that way. The plan had been meticulously thought out and practiced again and again. There was only one possible result once it had been implemented, but as they stood there the result wasn't anything close to what it should have been. They all blankly looked at each wondering how this could have happened. In their minds, they all began to blame the other members of the group as to why they had failed. Cake or pie? I can tell a lot about you by which one you pick. It may seem silly, but cake people and pie people are really different. I know which one I hope you are, but that's not for me to decide. So, what is it? Cake or pie?",
        "At that moment, she realized that she had created her current life. It wasn't the life she wanted, but she took responsibility for how it currently stood. Something clicked and she saw that every choice she made to this point in her life had led to where her life stood at this very moment even if she knew this wasn't where she wanted to be. She determined to choose to change it.",
        "Eating raw fish didn't sound like a good idea. 'It's a delicacy in Japan,' didn't seem to make it any more appetizing. Raw fish is raw fish, delicacy or not.It was that terrifying feeling you have as you tightly hold the covers over you with the knowledge that there is something hiding under your bed. You want to look, but you don't at the same time. You're frozen with fear and unable to act. That's where she found herself and she didn't know what to do next",
        "Things aren't going well at all with mom today. She is just a limp noodle and wants to sleep all the time. I sure hope that things get better soon.",
        "Peter always saw the world in black and white. There were two choices for every situation and you had to choose one of them. It was therefore terribly uncomfortable for him to spend time with Ashley. She saw the world in shades of gray with hundreds of choices to choose from in every situation.",
      ],
    },
    {
      url: "page2.html",
      breadcrumb: ["Home", "Hiburan", "Selebritas"],
      category: "Hiburan",
      topics: ["rekomendasi film", "trivia film", "film netflix"],
      title: "5 Film dan Drama Mengharukan tentang Keluarga",
      subtitle: "",
      author: "Sunnaholomi Halakrispen",
      date: "26 Juni 2021 09:00",
      imageAlt: "Film Ali & Ratu Ratu Queens (Foto: dok. netflix)",
      imageSrc:
        "https://cdn.medcom.id/dynamic/content/2021/06/25/1292679/XQvScZ5hpN.jpeg?w=1024",
      listText: [
        "Jakarta: Salah satu cara asyik menikmati waktu akhir pekan ialah dengan menonton film atau tayangan menarik. Jika Anda mengalami hari yang cukup berat dan ingin meluapkan emosi, coba saksikan beberapa tayangan di Netflix yang mampu menguras emosi.Berikut ini film dan drama bertema keluarga. Kisah yang ditayangkan tidak hanya akan menyentuh hati, namun juga membuat Anda lebih menghargai keluarga.",
        "1. Ali & Ratu Ratu Queens Film Netflix terbaru dari Indonesia Ali & Ratu Ratu Queens mengangkat kisah seorang anak laki-laki bernama Ali (diperankan Iqbaal Ramadhan). Ia pergi ke New York untuk mencari ibunya yang lama hidup terpisah. Sesampainya di sana, ia bertemu dengan empat wanita imigran Indonesia yang baik hati dan menyenangkan. Perjalanan Ali bersama Ratu Ratu pun menuntunnya pada sebuah pemahaman bahwa ada banyak cara untuk mendefinisikan arti keluarga. Dengan kehangatan cerita serta keindahan musik dan sinematografinya, Ali & Ratu Ratu Queens siap membuat Anda dipenuhi oleh berbagai macam emosi.",
        "2. Fatherhood Film terbaru Kevin Hart Fatherhood juga mampu menguras emosi dan air mata. Film ini mengisahkan Matthew Logelin, seorang single father yang harus membesarkan bayi perempuannya sendirian setelah kehilangan sang istri. Meskipun banyak menghadapi tantangan, Matthew tetap bertekad memberikan yang terbaik kepada putri satu-satunya. Diangkat dari kisah nyata, Fatherhood mengombinasikan unsur haru dengan komedi yang akan memecah tawa Anda saat mengikuti jalan ceritanya.",
        "3. Move To Heaven Serial Korea Move to Heaven berhasil mencuri perhatian lewat konsep ceritanya yang tak biasa. Drama ini menceritakan tentang seorang penghapus trauma dengan Sindrom Asperger bernama Han Geu-ru (diperankan Tang Jun-sang) dan pamannya yang seorang mantan narapidana Cho Sang-gu (diperankan Lee Je-hoon). Drama Korea ini membawa beragam kisah yang akan membuat Anda meneteskan air mata di setiap episodenya. Dinamika hubungan Geu-ru dan Sang-gu pun menjadi daya tarik utama di Move to Heaven. Meskipun awalnya kesulitan beradaptasi dengan satu sama lain, keduanya mampu mengesampingkan perbedaan yang ada. Mereka akhirnya sukses bekerja sama untuk menyampaikan pesan terakhir orang yang telah tiada kepada mereka yang dicintai.",
        "4. June & Kopi Siapa bilang hewan peliharaan tidak bisa menjadi keluarga kita? June & Kopi membuktikan hal ini lewat kisahnya yang menggemaskan sekaligus mengharukan mengenai persahabatan antara anjing dan manusia. Film ini dibintangi oleh Acha Septriasa, Ryan Delon, dan aktris cilik berbakat Makayla Rose Hilli. Film June & Kopi menceritakan seekor anjing jalanan bernama June yang diselamatkan oleh sepasang suami-istri. Seiring dengan kehidupan barunya, June pun akhirnya belajar untuk mempercayai serta menerima keluarga barunya. Sebuah tayangan mengenai keluarga yang sarat makna, June & Kopi juga mengajak kita untuk lebih menghargai hewan peliharaan kita.",
        "5. Hi Bye, Mama! Hi Bye, Mama! merupakan drama Korea yang akan membuat Anda berurai air mata. Serial ini menceritakan tentang Cha Yu-ri (diperankan Kim Tae-hee), hantu wanita yang mendapat kesempatan kedua untuk kembali hidup selama 49 hari. Dia pun harus mencoba menemukan tempatnya kembali di kehidupan baru anak dan suaminya yang kini telah menikah lagi. Hi Bye, Mama! menyuguhkan perjuangan dan penyesalan dari mereka yang telah meninggal dan ditinggalkan. Drama ini akan menghanyutkan Anda dengan pesan-pesannya yang berharga mengenai keluarga.",
      ],
    },
  ];

  let articleParent = $(".mid_content .lc_col");
  let articleText = document.querySelector(".article_ct .text");
  let currentNews = 0;
  let currentPage = 1;
  let nextPage = false;
  let outerHeightValue = 0;

  function loadFirstContent(countNews, textContainer, pageUrl) {
    let text = document.createElement("p");
    $(text).text(listNews[countNews].listText[0]);
    textContainer.append(text);
    text.style.marginBottom = "80px";
    history.pushState(null, null, pageUrl);
    return console.log("value count news " + countNews);
  }

  function loadContent(currentNews, textContainer, pageUrl, page, totalPage) {
    $(".loader").css("display", "block");
    let text = document.createElement("p");
    text.innerText = listNews[currentNews].listText[page];
    text.style.marginBottom = "80px";
    textContainer.append(text);
    history.pushState(null, null, `${pageUrl}?page=${page + 1}`);
    if (page === totalPage - 1) {
      $(".loader").css("display", "none");
    }
  }

  loadFirstContent(currentNews, articleText, listNews[currentNews].url);

  
  $(window).scroll(function () {
    // LOAD PAGINASI DATA
    if (
      $(this).scrollTop() >
        $(".article").eq(currentNews).find(".article_ct .text").outerHeight() +
          200 &&
      currentPage < listNews[currentNews].listText.length
    ) {
      if (nextPage === false) {
        loadContent(
          currentNews,
          articleText,
          listNews[currentNews].url,
          currentPage,
          listNews[currentNews].listText.length
        );
        
        currentPage++;

        if (currentPage === listNews[currentNews].listText.length) {
          nextPage = true;
        }
      }
    }

    // LOAD BERITA BARU APABILA SUDAH SCROLL SAMPAI PALING BAWAH
    // if (
    //   $(this).scrollTop() + $(this).height() > $(document).height() - 10 &&
    //   currentNews < listNews.length
    // ) {
    //   $("load_new_news").css("display", "block");
    //   currentPage = 1;
    //   currentNews++;

    //   if (currentNews < listNews.length) {
    //     $("load_new_news").css("display", "none");
    //     document.title = listNews[currentNews].title;

    //     let article = document.createElement("div");
    //     article.classList.add("article");

    //     // BREADCRUMB
    //     let breadcrumb = document.createElement("div");
    //     breadcrumb.classList.add("breadcrumb");
    //     let listBreadcrumb = document.createElement("ul");

    //     for (let i = 0; i < listNews[currentNews].breadcrumb.length; i++) {
    //       let breadcrumbItem = document.createElement("li");
    //       let breadcrumbLink = document.createElement("a");
    //       breadcrumbLink.innerText = listNews[currentNews].breadcrumb[i];
    //       breadcrumbLink.setAttribute("href", "");
    //       breadcrumbItem.append(breadcrumbLink);
    //       listBreadcrumb.append(breadcrumbItem);
    //     }

    //     breadcrumb.append(listBreadcrumb);
    //     article.append(breadcrumb);

    //     // SHOWING NEWS IMAGE AND IMAGE CAPTION
    //     let newsImageFigure = document.createElement("div");
    //     newsImageFigure.classList.add("pic");
    //     let newsImage = document.createElement("img");
    //     newsImage.setAttribute("src", listNews[currentNews].imageSrc);
    //     newsImage.setAttribute("alt", listNews[currentNews].imageAlt);
    //     let newsImageCaption = document.createElement("div");
    //     newsImageCaption.classList.add("caption");
    //     newsImageCaption.innerText = listNews[currentNews].imageAlt;

    //     newsImageFigure.append(newsImage);
    //     newsImageFigure.append(newsImageCaption);
    //     article.append(newsImageFigure);

    //     let contentContainer = document.createElement("div");
    //     contentContainer.classList.add("article_ct");

    //     //NEWS TITLE AND SUBTITLE
    //     let newsTitle = document.createElement("h1");
    //     newsTitle.innerText = listNews[currentNews].title;
    //     let newsSubtitle = document.createElement("h4");
    //     newsSubtitle.classList.add("subtitle");
    //     newsSubtitle.innerText = listNews[currentNews].subtitle;
    //     contentContainer.append(newsSubtitle);
    //     contentContainer.append(newsTitle);
    //     article.append(contentContainer);

    //     let footArticle = document.createElement("div");
    //     footArticle.classList.add("foot_article");

    //     //SET CATEGORY
    //     let category = document.createElement("a");
    //     category.setAttribute("title", "liga prancis");
    //     category.innerText = "Olahraga";
    //     footArticle.append(category);
    //     contentContainer.append(footArticle);

    //     // SET TOPICS
    //     for (let i = 0; i < listNews[currentNews].topics.length; i++) {
    //       let topic = document.createElement("a");
    //       let icon = document.createElement("i");
    //       icon.classList.add("fa", "fa-folder");
    //       topic.classList.add("topic");
    //       topic.setAttribute("title", listNews[currentNews].topics[i]);
    //       topic.append(icon);
    //       topic.append(` ${listNews[currentNews].topics[i]}`);
    //       //SET TOPICS LINK
    //       topic.setAttribute("href", "");
    //       footArticle.append(topic);
    //     }

    //     let info = document.createElement("div");
    //     info.classList.add("info");

    //     // CREATE AUTHOR & DATE
    //     let info_ct = document.createElement("div");
    //     info_ct.classList.add("info_ct");
    //     info_ct.innerText = `${listNews[currentNews].author} â€¢ ${listNews[currentNews].date}`;
    //     info.append(info_ct);
    //     contentContainer.append(info);

    //     // CLONE TOOL SECTION
    //     let tool = document.querySelector(".tool_bt").cloneNode(true);
    //     info.append(tool);

    //     // TEXT CONTENT
    //     let textContent = document.createElement("div");
    //     textContent.classList.add("text");

    //     textContent.setAttribute("id", "articleBody");
    //     textContent.setAttribute("itemprop", "articleBody");
    //     contentContainer.append(textContent);

    //     // CREATE LOADER ANIMATION
    //     // let loader = document.createElement("div");
    //     // let loadImage = document.createElement("div");
    //     // let loadingText = document.createElement("p");
    //     // loadingText.innerText = "LOADING";
    //     // loader.classList.add("loader");

    //     // loader.append(loadImage);
    //     // loader.append(loadingText);

    //     //SOCMED BUTTON
    //     let socmed = document.getElementById("stickshare");
    //     contentContainer.append(socmed);

    //     //BOTTOM ARTICLE
    //     let bottomArticle = document.createElement("div");
    //     bottomArticle.classList.add("bottom_article");
    //     let listBottomArticle = document.createElement("ul");
    //     let itemBottomArticle = document.createElement("li");
    //     let linkBottomArticle = document.createElement("a");
    //     linkBottomArticle.innerText = listNews[currentNews].breadcrumb[2];
    //     linkBottomArticle.setAttribute(
    //       "title",
    //       listNews[currentNews].breadcrumb[2]
    //     );
    //     linkBottomArticle.setAttribute("href", "");

    //     itemBottomArticle.append(linkBottomArticle);
    //     listBottomArticle.append(itemBottomArticle);
    //     bottomArticle.append(listBottomArticle);
    //     contentContainer.append(bottomArticle);

    //     articleParent.append(article);

    //     loadFirstContent(currentNews, textContent, listNews[currentNews].url);

    //     if (
    //       $(this).scrollTop() >
    //         $(".article")
    //           .eq(currentNews)
    //           .find(".article_ct .text")
    //           .outerHeight() +
    //           200 &&
    //       currentPage < listNews[currentNews].listText.length
    //     ) {
    //       loadContent(
    //         currentNews,
    //         $(".article").find(".article_ct .text"),
    //         listNews[currentNews].url,
    //         currentPage,
    //         listNews[currentNews].listText.length
    //       );
    //       currentPage++;
    //     }
    //   }
    // }
  });
});
